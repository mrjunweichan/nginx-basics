  
  
---
## Docker Containers
  
**Create docker folder**  
```shell
sudo mkdir -p /docker/
```
  
**Install jq**  
```shell
apt-get install jq -y
```
  
**Set up Docker apt repo**  
```shell
# Add Docker's official GPG key:
sudo apt-get update
sudo apt-get install ca-certificates curl -y
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc
sudo chmod a+r /etc/apt/keyrings/docker.asc

# Add the repository to Apt sources:
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \
  $(. /etc/os-release && echo "${UBUNTU_CODENAME:-$VERSION_CODENAME}") stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt-get update
```
  
**Install Docker packages**  
```shell
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin -y
```
  
**Pull images**  
```shell
docker pull swaggerapi/petstore
docker pull prom/prometheus
docker pull grafana/grafana
```
  
**Create docker-compose.yml**  
```shell
sudo mkdir -p /docker/
cat <<EOF >>/docker/docker-compose.yml
services:
  petstore:
    image: swaggerapi/petstore
    ports:
      - "80:8080"
    environment:
      SWAGGER_HOST: http://petstore.swagger.io
      SWAGGER_URL: http://localhost
      SWAGGER_BASE_PATH: /v2
    restart: unless-stopped
  prometheus:
    hostname: prometheus
    container_name: prometheus
    image: prom/prometheus
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml:ro
    ports:
      - "9090:9090"
    extra_hosts:
    - "host.docker.internal:host-gateway"
    restart: always
  grafana:
    hostname: grafana
    container_name: grafana
    image: grafana/grafana
    volumes:
      - grafana-storage:/var/lib/grafana
    ports:
      - "3000:3000"
    restart: always
volumes:
  grafana-storage:
    name: "grafana-storage"
    external: false
EOF
```
  
**Create prometheus.yml**  
```shell
cat <<EOF >>/docker/prometheus.yml
global:
  scrape_interval: 15s 
  external_labels:
    monitor: 'nginx-monitor'
scrape_configs:  
  - job_name: 'prometheus'
    scrape_interval: 5s
    static_configs:
      - targets: ['10.1.1.6:9113']
EOF
```
  
**Start docker containers**  
```shell
cd /docker
docker compose up --force-recreate -d
```

